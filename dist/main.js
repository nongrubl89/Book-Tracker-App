(()=>{function e(e,t,n,o,a){this.title=e,this.author=t,this.hasRead=n,this.starRating=o,this.showOtherBooks=a}const t=new e("My Brilliant Friend","Elena Ferrante",!0,"★ ★ ★ ★ ★","","",""),n=[];function o(e){n.push(e)}function a(e){e.forEach(((t,n)=>{if(n===e.length-1){const e=document.querySelector(".books-container"),o=document.createElement("div");o.dataset.id=n,t.hasRead?o.className="read-book-div":o.className="unread-book-div",o.innerHTML=`<h3 class = 'book-title'>${t.title}</h3>\n                          <h3 class ="book-author">${t.author}</h3>\n                          ${t.starRating?`<div class="stars">${t.starRating}</div>`:"<span></span>"}</span>\n                          <button class='delete'><img src="trashcan.png"/></button>\n                          <button class='edit'><img src="edit.png"/></button>\n                          <button class='more-books'>More Books by ${t.author}</button>`,e.appendChild(o)}!function(e){document.querySelectorAll(".delete").forEach((function(t){t.addEventListener("click",(function(){l(e)}))}))}(n),document.querySelectorAll(".more-books").forEach((e=>e.addEventListener("click",(()=>getBooksByAuthor().then((e=>function(e){const t=document.querySelector(".overlay"),n=document.getElementById("text-overlay");if(document.getElementById("remove-overlay").addEventListener("click",(()=>t.style.display="none")),0===e.results.length)return void alert("Cannot find author in database, check spelling and try again");t.style.display="block",console.log(e.results);const o=e.results.reduce(((e,t)=>(e.some((e=>e.book_title===t.book_title))||e.push(t),e)),[]).map((e=>(""===e.summary&&(e.summary="No Summary Available"),e))).map((e=>`<div class='more-by-author'><h3>${e.book_title}</h3><p>${e.summary}</p><a href =${e.url}>More Here</a></div>`));n.innerHTML=o.join("<hr/>"),console.log(n)}(e))))))),document.querySelectorAll(".edit").forEach((function(e){e.addEventListener("click",(function(){!function(){const e=event.target.parentNode.parentNode.dataset.id,t=event.target.parentNode.parentNode.children[0],n=event.target.parentNode.parentNode.children[1],o=t.innerHTML,a=n.innerHTML;m.value=o,h.value=a,l(e),editAuthorListener(n)}()}))}))}))}function s(){if("Yes"===d.value)u.style.display="block";else for(d.value,u.style.display="none",i=0;i<c.length;i++)c[i].classList.remove("select")}function r(e){let t=e.toLowerCase().split(" ");for(var n=0;n<t.length;n++)t[n]=t[n].charAt(0).toUpperCase()+t[n].substring(1);return t.join(" ")}function l(e){const t=event.target.parentNode.parentNode;n.splice(e,1),t.remove(t)}o(t),getBooksByAuthor=async()=>{console.log("clicked");const e=n[event.target.parentNode.dataset.id].author;console.log(e);const t=e.split(" ").join("+"),o=await fetch(`https://api.nytimes.com/svc/books/v3/reviews.json?author=${t}&api-key=fsaJyExrkFogrVr0yM5V1nH6ke9YfUwY`,{mode:"cors"});return await o.json()};let c=document.querySelectorAll(".selected");const d=document.getElementById("read"),u=document.querySelector(".Rating"),m=document.getElementById("title"),h=document.getElementById("author"),g=document.getElementById("read"),v=document.getElementById("submit");document.addEventListener("click",(function(e){let t=e.target.getAttribute("data-star");if(e.target.matches(".selected"))for(e.preventDefault(),i=0;i<c.length;i++)i<t?c[i].classList.add("select"):c[i].classList.remove("select")}),!1),document.addEventListener("mouseover",(function(e){if(e.target.matches(".selected")){e.preventDefault();let t=e.target.getAttribute("data-star");for(i=0;i<c.length;i++)i<t?c[i].classList.add("select"):c[i].classList.remove("select")}}),!1),v.addEventListener("click",(()=>{!function(){if(event.preventDefault(),""==m.value||""==h.value)alert("Please fill in all fields");else{let t=document.getElementById("rate").getElementsByClassName("select").length,s="★ ".repeat(t),l=new e(r(m.value),r(h.value),g.value,starRating=s,showOtherBooks="");document.getElementById("read").value,o(l),a(n),document.getElementById("bookInfo").reset()}}(),s()})),d.addEventListener("change",(()=>{s()})),a(n)})();